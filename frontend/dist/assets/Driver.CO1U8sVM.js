import{u as de,q as I,p as G,w as P,r as k,i as b,s as U,j as e,A as me,t as w,x as K,c as X,n as ue,B as pe,m as ge,y as Y,h as L,k as ee,C as se}from"./index.CmCHOKX_.js";import{b as xe,r as c}from"./react.C2-qyGTQ.js";import{M as he,T as fe,b as F,L as te,P as q,d as be}from"./leaflet.DC9QlCQY.js";const z=new te.Icon({iconUrl:"https://unpkg.com/leaflet@1.9.4/dist/images/marker-icon.png",iconRetinaUrl:"https://unpkg.com/leaflet@1.9.4/dist/images/marker-icon-2x.png",shadowUrl:"https://unpkg.com/leaflet@1.9.4/dist/images/marker-shadow.png",iconSize:[25,41],iconAnchor:[12,41],popupAnchor:[1,-34],shadowSize:[41,41]}),je=new te.Icon({iconUrl:"https://raw.githubusercontent.com/pointhi/leaflet-color-markers/master/img/marker-icon-red.png",iconRetinaUrl:"https://raw.githubusercontent.com/pointhi/leaflet-color-markers/master/img/marker-icon-2x-red.png",iconSize:[25,41],iconAnchor:[12,41],popupAnchor:[1,-34],shadowSize:[41,41]});function ve({onSelect:d}){const S=be();return c.useEffect(()=>{if(!S)return;const h=f=>{d(f.latlng)};return S.on("click",h),()=>{S.off("click",h)}},[S,d]),null}function Ce(){const{currentUser:d,logout:S}=de();xe();const[h,f]=c.useState("available"),re=()=>e.jsxs("div",{className:"flex border-b border-gray-200 mb-4",children:[e.jsx("button",{className:`py-2 px-4 font-medium ${O?"text-gray-500 hover:text-gray-700":"text-blue-600 border-b-2 border-blue-600"}`,onClick:()=>W(!1),children:"Viajes Activos"}),e.jsx("button",{className:`py-2 px-4 font-medium ${O?"text-blue-600 border-b-2 border-blue-600":"text-gray-500 hover:text-gray-700"}`,onClick:()=>W(!0),children:"Historial"})]}),[A,H]=c.useState([]),[C,M]=c.useState([]),[V,B]=c.useState([]),[O,W]=c.useState(!1),[j,y]=c.useState(!1),[p,_]=c.useState(null),[g,Q]=c.useState(null),[v,J]=c.useState({departureTime:"",availableSeats:1,price:0,carModel:"",carPlate:"",estimatedDuration:""}),[ye,ae]=c.useState(null),[i,R]=c.useState(null),x=c.useRef(),ne=c.useRef(!1),E=c.useRef(null),T=(s,t,a=15)=>{if(!x.current)return console.log("Map reference not available, storing pending center:",{lat:s,lng:t}),E.current={lat:s,lng:t,zoom:a},!1;try{return console.log("Centering map to:",{lat:s,lng:t,zoom:a}),x.current.setView([s,t],a,{animate:!0,duration:.5}),setTimeout(()=>{x.current&&x.current.flyTo([s,t],a,{animate:!0,duration:1.5,easeLinearity:.5})},50),!0}catch(r){return console.error("Error centering map:",r),!1}};c.useEffect(()=>{if(!(i!=null&&i.origin))return;const{lat:s,lng:t}=i.origin;if(typeof s!="number"||typeof t!="number"||isNaN(s)||isNaN(t)){console.error("Invalid coordinates in acceptedTrip:",{lat:s,lng:t});return}if(!T(s,t)){const r=setTimeout(()=>{T(s,t)},500);return()=>clearTimeout(r)}},[i]),c.useEffect(()=>{if(!d)return;const s=localStorage.getItem("acceptedTrip");if(s){const r=JSON.parse(s);if(r!=null&&r.origin){const n=setTimeout(()=>{if(x.current){const{lat:o,lng:l}=r.origin;x.current.flyTo([o,l],15,{animate:!0,duration:1.5,easeLinearity:.5})}},500);return()=>clearTimeout(n)}}const t=I(k(b,"rideRequests"),P("status","==","pending"),G("createdAt","desc")),a=U(t,r=>{const n=[];r.forEach(o=>{n.push({id:o.id,...o.data()})}),H(n)});return()=>a()},[d]),c.useEffect(()=>{if(!d)return;console.log("=== Setting up Firestore listeners ==="),console.log("User ID:",d.uid);const s=I(k(b,"trips"),P("driverId","==",d.uid),G("createdAt","desc"));console.log("Setting up trips query for driver:",d.uid);const t=U(s,n=>{const o=[];n.forEach(m=>{o.push({id:m.id,...m.data()})});const l=o.filter(m=>["requested","accepted","in_progress"].includes(m.status)),u=o.filter(m=>m.status==="completed");console.log("=== Trips update ==="),console.log("Active trips:",l.length),console.log("Completed trips:",u.length),M(l),B(u)},n=>{console.error("Error fetching trips:",n)}),a=I(k(b,"rideRequests"),P("driverId","==",d.uid),P("status","==","accepted")),r=U(a,n=>{const o=[];n.forEach(l=>{o.push({id:l.id,...l.data()})}),o.length>0&&M(l=>{const u=new Set(l.map(D=>D.id)),m=o.filter(D=>!u.has(D.id));return[...l,...m]})},n=>{console.error("Error fetching ride requests:",n)});return()=>{t(),r()}},[d]);const ie=s=>{p?g||Q({...s,name:"Destino"}):_({...s,name:"Origen"})},N=s=>{const{name:t,value:a}=s.target;J(r=>({...r,[t]:t==="availableSeats"||t==="price"?parseInt(a)||0:a}))},oe=async s=>{if(s.preventDefault(),!p||!g){alert("Por favor selecciona origen y destino en el mapa");return}y(!0);try{const t={driverId:d.uid,driverName:d.displayName,origin:p,destination:g,...v,status:"available",createdAt:new Date().toISOString(),passengers:[]};await Y(k(b,"trips"),t),_(null),Q(null),J({departureTime:"",availableSeats:1,price:0,carModel:"",carPlate:"",estimatedDuration:""}),alert("¡Viaje creado exitosamente!"),f("my-trips")}catch(t){console.error("Error creating trip: ",t),alert("Error al crear el viaje. Por favor intenta de nuevo.")}finally{y(!1)}};c.useEffect(()=>{if(i!=null&&i.origin&&x.current){const{lat:s,lng:t}=i.origin;x.current.flyTo([s,t],15,{animate:!0,duration:1.5})}},[i]);const Z=async s=>{if(d)try{y(!0);const t=A.find(u=>u.id===s);if(!t)throw new Error("No se encontró el viaje seleccionado");if(!t.origin||typeof t.origin.lat!="number"||typeof t.origin.lng!="number")throw console.error("Invalid trip origin coordinates:",t.origin),new Error("El viaje no tiene una ubicación de origen válida");const a={...t,origin:{lat:parseFloat(t.origin.lat),lng:parseFloat(t.origin.lng),name:t.origin.name||"Origen"}};R(a),console.log("Trip accepted, updating state with:",a);const{lat:r,lng:n}=a.origin;T(r,n);const o={...t,status:"accepted",driverId:d.uid,driverName:d.displayName||"Conductor",passengerId:t.passengerId,passengerName:t.passengerName,origin:t.origin,destination:t.destination,price:t.price||0,passengers:t.passengers||1,departureTime:t.departureTime||new Date().toISOString(),createdAt:new Date().toISOString(),updatedAt:new Date().toISOString()};await Y(k(b,"trips"),o);const l=L(b,"rideRequests",s);await ee(l,{status:"accepted",driverId:d.uid,driverName:d.displayName||"Conductor",updatedAt:new Date().toISOString()}),H(u=>u.filter(m=>m.id!==s)),alert("¡Has aceptado el viaje exitosamente! Dirígete a la ubicación del pasajero."),f("my-trips")}catch(t){console.error("Error accepting trip:",t),alert("Error al aceptar el viaje. Por favor, inténtalo de nuevo.")}finally{y(!1)}},le=async s=>{if(console.log("=== [handleCompleteTrip] Starting ==="),console.log("Trip ID:",s),console.log("Current myTrips:",C),!s){console.error("No trip ID provided for completion"),alert("No se pudo identificar el viaje a completar");return}const t=C.find(r=>r.id===s);if(!t){const r=`Trip ${s} not found in active trips`;console.error(r),console.log("Available trip IDs:",C.map(n=>n.id)),alert("No se pudo encontrar el viaje activo para completar");return}console.log("Trip to complete found:",t);const a={...t,status:"completed",updatedAt:new Date().toISOString(),completedAt:new Date().toISOString()};try{y(!0),console.log("Starting trip completion process...");let r=L(b,"trips",s),n=await se(r),o="trips";if(!n.exists()&&(console.log("Trip not found in 'trips' collection, checking 'rideRequests'..."),o="rideRequests",r=L(b,"rideRequests",s),n=await se(r),!n.exists())){const u=`Trip ${s} not found in either collection`;throw console.error(u),new Error("El viaje no existe en la base de datos")}console.log(`Found trip in collection: ${o}/${s}`),console.log("Current trip data:",n.data());const l={status:"completed",updatedAt:new Date().toISOString(),completedAt:new Date().toISOString()};console.log("Attempting to update with data:",l),await ee(r,l),console.log("✅ Successfully updated trip in Firestore"),console.log("Updating local state..."),M(u=>{const m=u.filter(D=>D.id!==s);return console.log("Updated myTrips (after filter):",m),m}),B(u=>{const m=[a,...u];return console.log("Updated tripHistory (after add):",m),m}),(i==null?void 0:i.id)===s&&(console.log("Clearing accepted trip from state and localStorage"),R(null),localStorage.removeItem("acceptedTrip")),console.log("✅ Trip marked as completed successfully"),alert("¡Viaje completado exitosamente!")}catch(r){console.error("❌ Error completing trip:",{error:r,code:r.code,message:r.message,stack:r.stack});let n="Error al completar el viaje. Por favor, inténtalo de nuevo.";r.code==="permission-denied"?(console.error("Permission denied - check Firestore rules"),n="No tienes permiso para completar este viaje."):(r.code==="not-found"||r.message.includes("no existe")||r.message.includes("not found"))&&(n="El viaje no existe o ya ha sido completado"),alert(n),(r.code==="not-found"||r.message.includes("no existe"))&&(console.log("Cleaning up local state for non-existent trip"),M(o=>o.filter(l=>l.id!==s)),(i==null?void 0:i.id)===s&&(R(null),localStorage.removeItem("acceptedTrip")))}finally{y(!1)}},$=s=>{if(!s)return"No especificada";try{const t={weekday:"long",year:"numeric",month:"long",day:"numeric",hour:"2-digit",minute:"2-digit"},a=new Date(s);return isNaN(a.getTime())?"Fecha inválida":a.toLocaleDateString("es-ES",t)}catch(t){return console.error("Error formatting date:",t),"Fecha inválida"}},ce=s=>{if(console.log("Map instance loaded"),x.current=s,ae(s),ne.current=!0,E.current){const{lat:a,lng:r,zoom:n}=E.current;T(a,r,n),E.current=null}else if(i!=null&&i.origin){const{lat:a,lng:r}=i.origin;typeof a=="number"&&typeof r=="number"&&T(a,r)}const t=()=>{if(x.current){const a=x.current.getCenter();console.log("Map moved to:",{lat:a.lat,lng:a.lng,zoom:x.current.getZoom()})}};return s.on("moveend",t),()=>{s.off("moveend",t)}};return e.jsx("div",{className:"min-h-screen bg-gray-50",children:e.jsx("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-8",children:e.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-3 gap-8",children:[e.jsx("div",{className:"lg:col-span-1 space-y-6",children:e.jsxs("div",{className:"bg-white rounded-lg shadow-md p-6",children:[e.jsx("h2",{className:"text-xl font-bold text-gray-800 mb-4",children:"Panel del Conductor"}),e.jsxs("div",{className:"flex border-b mb-4",children:[e.jsx("button",{className:`flex-1 py-2 font-medium ${h==="available"?"text-blue-600 border-b-2 border-blue-600":"text-gray-500 hover:text-gray-700"}`,onClick:()=>f("available"),children:"Viajes Disponibles"}),e.jsx("button",{className:`flex-1 py-2 font-medium ${h==="my-trips"?"text-blue-600 border-b-2 border-blue-600":"text-gray-500 hover:text-gray-700"}`,onClick:()=>f("my-trips"),children:"Mis Viajes"}),e.jsx("button",{className:`flex-1 py-2 font-medium ${h==="create-trip"?"text-blue-600 border-b-2 border-blue-600":"text-gray-500 hover:text-gray-700"}`,onClick:()=>f("create-trip"),children:e.jsx(me,{className:"inline mr-1"})})]}),h==="available"&&e.jsxs("div",{className:"space-y-4",children:[e.jsx("h3",{className:"font-medium text-gray-900",children:"Solicitudes de viaje"}),A.length===0?e.jsx("p",{className:"text-sm text-gray-500 py-4 text-center",children:"No hay viajes disponibles en este momento"}):e.jsx("div",{className:"space-y-4",children:A.map(s=>{var t,a;return e.jsxs("div",{className:"border rounded-lg p-4 space-y-3",children:[e.jsxs("div",{className:"flex items-center",children:[e.jsx(w,{className:"text-red-500 mr-2 w-4"}),e.jsx("span",{className:"truncate",children:((t=s.origin)==null?void 0:t.name)||"Origen no especificado"})]}),e.jsxs("div",{className:"flex items-center",children:[e.jsx(w,{className:"text-green-500 mr-2 w-4"}),e.jsx("span",{className:"truncate",children:((a=s.destination)==null?void 0:a.name)||"Destino no especificado"})]}),e.jsxs("div",{className:"flex items-center text-gray-500",children:[e.jsx(K,{className:"mr-2 w-4"}),e.jsx("span",{children:$(s.departureTime)})]}),e.jsxs("div",{className:"flex items-center text-gray-500",children:[e.jsx(X,{className:"mr-2 w-4"}),e.jsxs("span",{children:[s.passengers||1," pasajero",s.passengers!==1?"s":""]})]}),e.jsxs("div",{className:"flex items-center text-lg font-semibold text-blue-600",children:[e.jsx(ue,{className:"mr-2"}),"$",(s.price||0).toLocaleString()]}),e.jsx("button",{onClick:()=>Z(s.id),className:"w-full bg-green-600 text-white py-2 rounded-lg font-medium hover:bg-green-700 transition-colors flex items-center justify-center",disabled:j,children:j?e.jsxs(e.Fragment,{children:[e.jsxs("svg",{className:"animate-spin -ml-1 mr-2 h-4 w-4 text-white",xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",children:[e.jsx("circle",{className:"opacity-25",cx:"12",cy:"12",r:"10",stroke:"currentColor",strokeWidth:"4"}),e.jsx("path",{className:"opacity-75",fill:"currentColor",d:"M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"})]}),"Procesando..."]}):e.jsxs(e.Fragment,{children:[e.jsx(pe,{className:"mr-2"}),"Aceptar viaje"]})})]},s.id)})})]}),h==="my-trips"&&e.jsxs("div",{className:"space-y-4",children:[re(),O?V.length>0?V.map(s=>{var t,a;return e.jsx("div",{className:"bg-white rounded-lg shadow-md p-4 border-l-4 border-green-500",children:e.jsxs("div",{className:"flex justify-between items-start",children:[e.jsxs("div",{children:[e.jsxs("h3",{className:"font-medium text-gray-900",children:[((t=s.origin)==null?void 0:t.name)||"Origen desconocido"," → ",((a=s.destination)==null?void 0:a.name)||"Destino desconocido"]}),e.jsx("p",{className:"text-sm text-gray-500",children:s.passengerName?`Pasajero: ${s.passengerName}`:"Pasajero no especificado"}),e.jsxs("p",{className:"text-sm text-gray-500",children:["Precio: $",s.price||"No especificado"]}),s.completedAt&&e.jsxs("p",{className:"text-xs text-gray-400 mt-1",children:["Completado: ",$(s.completedAt)]})]}),e.jsx("span",{className:"inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-medium bg-green-100 text-green-800",children:"Completado"})]})},s.id)}):e.jsx("div",{className:"text-center py-8",children:e.jsx("p",{className:"text-gray-500",children:"Aún no tienes viajes completados en tu historial."})}):C.length>0?C.map(s=>{var t,a,r,n,o,l;return e.jsxs("div",{className:"border rounded-lg p-4 hover:shadow-md transition-shadow",children:[e.jsxs("div",{className:"flex justify-between items-start mb-3",children:[e.jsxs("div",{children:[e.jsxs("h4",{className:"font-medium",children:[((a=(t=s.origin)==null?void 0:t.name)==null?void 0:a.split(",")[0])||"Origen"," → ",((n=(r=s.destination)==null?void 0:r.name)==null?void 0:n.split(",")[0])||"Destino"]}),e.jsx("span",{className:`inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-medium ${s.status==="accepted"?"bg-blue-100 text-blue-800":s.status==="completed"?"bg-gray-100 text-gray-800":s.status==="in_progress"?"bg-yellow-100 text-yellow-800":"bg-green-100 text-green-800"}`,children:s.status==="accepted"?"Aceptado":s.status==="completed"?"Completado":s.status==="in_progress"?"En curso":"Disponible"})]}),e.jsxs("div",{className:"text-right",children:[e.jsxs("div",{className:"text-xl font-bold text-blue-600",children:["$",(s.price||0).toLocaleString()]}),e.jsxs("div",{className:"text-sm text-gray-500",children:[s.passengers," pasajero",s.passengers!==1?"s":""]})]})]}),e.jsxs("div",{className:"space-y-2 text-sm mb-4",children:[e.jsxs("div",{className:"flex items-center",children:[e.jsx(w,{className:"text-red-500 mr-2 w-4"}),e.jsx("span",{className:"truncate",children:((o=s.origin)==null?void 0:o.name)||"Origen no especificado"})]}),e.jsxs("div",{className:"flex items-center",children:[e.jsx(w,{className:"text-green-500 mr-2 w-4"}),e.jsx("span",{className:"truncate",children:((l=s.destination)==null?void 0:l.name)||"Destino no especificado"})]}),e.jsxs("div",{className:"flex items-center text-gray-500",children:[e.jsx(K,{className:"mr-2 w-4"}),e.jsx("span",{children:$(s.departureTime)})]}),s.carModel&&e.jsxs("div",{className:"flex items-center text-gray-500",children:[e.jsx(ge,{className:"mr-2 w-4"}),e.jsxs("span",{children:[s.carModel," ",s.carPlate?`• ${s.carPlate}`:""]})]}),s.passengerName&&e.jsxs("div",{className:"mt-2 pt-2 border-t",children:[e.jsx("p",{className:"font-medium text-sm mb-1",children:"Pasajero:"}),e.jsxs("div",{className:"flex items-center text-sm text-gray-600",children:[e.jsx(X,{className:"mr-2 w-4 text-gray-400"}),e.jsx("span",{children:s.passengerName})]})]})]}),s.status==="accepted"&&e.jsx("div",{className:"flex gap-2",children:e.jsx("button",{onClick:()=>le(s.id),className:"flex-1 bg-green-600 text-white py-2 rounded-lg font-medium hover:bg-green-700 transition-colors",disabled:j,children:j?"Procesando...":"Completar viaje"})})]},s.id)}):e.jsxs("div",{className:"text-center py-8 text-gray-500",children:[e.jsx("p",{children:"No tienes viajes activos"}),e.jsx("button",{className:"mt-4 text-blue-600 hover:text-blue-800 font-medium",onClick:()=>f("create-trip"),children:"Crear un nuevo viaje"})]})]}),h==="create-trip"&&e.jsxs("form",{onSubmit:oe,children:[e.jsx("h3",{className:"font-medium text-gray-900 mb-4",children:"Crear nuevo viaje"}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Origen"}),e.jsxs("div",{className:"flex items-center bg-gray-100 rounded-lg p-3",children:[e.jsx(w,{className:"text-red-500 mr-2"}),e.jsx("span",{children:(p==null?void 0:p.name)||"Selecciona en el mapa"})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Destino"}),e.jsxs("div",{className:"flex items-center bg-gray-100 rounded-lg p-3",children:[e.jsx(w,{className:"text-green-500 mr-2"}),e.jsx("span",{children:(g==null?void 0:g.name)||"Selecciona en el mapa"})]})]}),e.jsxs("div",{children:[e.jsx("label",{htmlFor:"departureTime",className:"block text-sm font-medium text-gray-700 mb-1",children:"Fecha y hora de salida"}),e.jsx("input",{type:"datetime-local",id:"departureTime",name:"departureTime",value:v.departureTime,onChange:N,className:"w-full px-3 py-2 border border-gray-300 rounded-md shadow-sm focus:outline-none focus:ring-blue-500 focus:border-blue-500",required:!0})]}),e.jsxs("div",{children:[e.jsx("label",{htmlFor:"availableSeats",className:"block text-sm font-medium text-gray-700 mb-1",children:"Asientos disponibles"}),e.jsx("input",{type:"number",id:"availableSeats",name:"availableSeats",min:"1",max:"10",value:v.availableSeats,onChange:N,className:"w-full px-3 py-2 border border-gray-300 rounded-md shadow-sm focus:outline-none focus:ring-blue-500 focus:border-blue-500",required:!0})]}),e.jsxs("div",{children:[e.jsx("label",{htmlFor:"price",className:"block text-sm font-medium text-gray-700 mb-1",children:"Precio por asiento"}),e.jsxs("div",{className:"mt-1 relative rounded-md shadow-sm",children:[e.jsx("div",{className:"absolute inset-y-0 left-0 pl-3 flex items-center pointer-events-none",children:e.jsx("span",{className:"text-gray-500 sm:text-sm",children:"$"})}),e.jsx("input",{type:"number",id:"price",name:"price",min:"0",value:v.price,onChange:N,className:"w-full pl-7 pr-3 py-2 border border-gray-300 rounded-md shadow-sm focus:outline-none focus:ring-blue-500 focus:border-blue-500",required:!0})]})]}),e.jsxs("div",{children:[e.jsx("label",{htmlFor:"carModel",className:"block text-sm font-medium text-gray-700 mb-1",children:"Modelo del vehículo"}),e.jsx("input",{type:"text",id:"carModel",name:"carModel",value:v.carModel,onChange:N,className:"w-full px-3 py-2 border border-gray-300 rounded-md shadow-sm focus:outline-none focus:ring-blue-500 focus:border-blue-500",placeholder:"Ej: Toyota Corolla 2020",required:!0})]}),e.jsxs("div",{children:[e.jsx("label",{htmlFor:"carPlate",className:"block text-sm font-medium text-gray-700 mb-1",children:"Placa del vehículo"}),e.jsx("input",{type:"text",id:"carPlate",name:"carPlate",value:v.carPlate,onChange:N,className:"w-full px-3 py-2 border border-gray-300 rounded-md shadow-sm focus:outline-none focus:ring-blue-500 focus:border-blue-500",placeholder:"Ej: ABC123",required:!0})]}),e.jsxs("div",{children:[e.jsx("label",{htmlFor:"estimatedDuration",className:"block text-sm font-medium text-gray-700 mb-1",children:"Duración estimada"}),e.jsx("input",{type:"text",id:"estimatedDuration",name:"estimatedDuration",value:v.estimatedDuration,onChange:N,className:"w-full px-3 py-2 border border-gray-300 rounded-md shadow-sm focus:outline-none focus:ring-blue-500 focus:border-blue-500",placeholder:"Ej: 45 min"})]}),e.jsx("div",{className:"pt-2",children:e.jsx("button",{type:"submit",disabled:!p||!g||j,className:`w-full bg-blue-600 text-white py-3 px-4 rounded-lg font-medium flex items-center justify-center ${!p||!g||j?"opacity-50 cursor-not-allowed":"hover:bg-blue-700"}`,children:j?e.jsxs(e.Fragment,{children:[e.jsxs("svg",{className:"animate-spin -ml-1 mr-2 h-5 w-5 text-white",xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",children:[e.jsx("circle",{className:"opacity-25",cx:"12",cy:"12",r:"10",stroke:"currentColor",strokeWidth:"4"}),e.jsx("path",{className:"opacity-75",fill:"currentColor",d:"M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"})]}),"Creando viaje..."]}):"Publicar viaje"})})]})]})]})}),e.jsx("div",{className:"lg:col-span-2 bg-white rounded-xl shadow-md overflow-hidden w-full h-[400px] lg:h-auto",children:e.jsx("div",{className:"w-full h-full",children:e.jsxs(he,{center:[5.2226,-76.0307],zoom:13,style:{height:"100%",width:"100%",minHeight:"400px"},zoomControl:!0,whenCreated:ce,children:[e.jsx(fe,{url:"https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png",attribution:'© <a href="https://www.openstreetmap.org/copyright">OpenStreetMap</a> contributors'}),(i==null?void 0:i.origin)&&e.jsx(F,{position:[i.origin.lat,i.origin.lng],icon:je,children:e.jsx(q,{children:e.jsxs("div",{className:"text-sm",children:[e.jsxs("div",{className:"font-medium",children:["Recoger a ",i.passengerName||"el pasajero"]}),e.jsx("div",{children:i.origin.name||"Ubicación del pasajero"})]})})}),p&&e.jsx(F,{position:[p.lat,p.lng],icon:z,children:e.jsxs(q,{children:["Origen: ",p.name||"Ubicación de recogida"]})}),g&&e.jsx(F,{position:[g.lat,g.lng],icon:z,children:e.jsxs(q,{children:["Destino: ",g.name||"Ubicación de destino"]})}),h==="available"&&A.map(s=>e.jsx(F,{position:[s.origin.lat,s.origin.lng],icon:z,children:e.jsx(q,{children:e.jsxs("div",{className:"text-sm",children:[e.jsx("div",{className:"font-medium",children:"Solicitud de viaje"}),e.jsxs("div",{children:["De: ",s.origin.name||"Origen"]}),e.jsxs("div",{children:["A: ",s.destination.name||"Destino"]}),e.jsxs("div",{children:["Pasajeros: ",s.passengers||1]}),e.jsxs("div",{children:["Precio: $",(s.price||0).toLocaleString()]}),e.jsx("button",{onClick:()=>Z(s.id),className:"mt-2 w-full bg-green-600 text-white py-1 px-2 rounded text-xs font-medium hover:bg-green-700",children:"Aceptar viaje"})]})})},s.id)),h==="create-trip"&&e.jsx(ve,{onSelect:ie})]})})})]})})})}export{Ce as default};
