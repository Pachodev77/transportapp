{"version":3,"file":"Driver-CMTYWWFJ.js","sources":["../../src/pages/Driver.jsx"],"sourcesContent":["import React, { useState, useEffect, useRef, useCallback } from 'react';\nimport { useNavigate } from 'react-router-dom';\nimport { MapContainer, TileLayer, Marker, Popup, useMap } from 'react-leaflet';\nimport { FaCar, FaMapMarkerAlt, FaClock, FaUser, FaMoneyBillWave, FaStar, FaPlus, FaCheck, FaTimes, FaSpinner } from 'react-icons/fa';\nimport { useAuth } from '../contexts/AuthContext';\nimport { \n  getTripsByStatus as getTrips,\n  getUserTrips, \n  updateTripStatus, \n  createTrip, \n  subscribeToTripUpdates,\n  subscribeToTrips,\n  db\n} from '../firebase/config';\nimport { onSnapshot, doc, setDoc, serverTimestamp, GeoPoint } from 'firebase/firestore';\nimport 'leaflet/dist/leaflet.css';\nimport L from 'leaflet';\nimport { STRINGS } from '../utils/constants';\nimport Button from '../components/Button';\n\n// Fix for default marker icons\nconst defaultIcon = new L.Icon({\n  iconUrl: 'https://unpkg.com/leaflet@1.9.4/dist/images/marker-icon.png',\n  iconRetinaUrl: 'https://unpkg.com/leaflet@1.9.4/dist/images/marker-icon-2x.png',\n  shadowUrl: 'https://unpkg.com/leaflet@1.9.4/dist/images/marker-shadow.png',\n  iconSize: [25, 41],\n  iconAnchor: [12, 41],\n  popupAnchor: [1, -34],\n  shadowSize: [41, 41]\n});\n\n// Custom icon for passenger location\nconst passengerIcon = new L.Icon({\n  iconUrl: 'https://raw.githubusercontent.com/pointhi/leaflet-color-markers/master/img/marker-icon-red.png',\n  iconRetinaUrl: 'https://raw.githubusercontent.com/pointhi/leaflet-color-markers/master/img/marker-icon-2x-red.png',\n  iconSize: [25, 41],\n  iconAnchor: [12, 41],\n  popupAnchor: [1, -34],\n  shadowSize: [41, 41]\n});\n\nfunction LocationSelector({ onSelect }) {\n  const map = useMap();\n  \n  useEffect(() => {\n    if (!map) return;\n    \n    const handleClick = (e) => {\n      onSelect(e.latlng);\n    };\n    \n    map.on('click', handleClick);\n    \n    return () => {\n      map.off('click', handleClick);\n    };\n  }, [map, onSelect]);\n  \n  return null;\n}\n\nfunction Driver() {\n  const { currentUser, logout } = useAuth();\n  const navigate = useNavigate();\n  const [activeTab, setActiveTab] = useState('available');\n  const [currentPosition, setCurrentPosition] = useState(null);\n\n  useEffect(() => {\n    const watchId = navigator.geolocation.watchPosition(\n      (position) => {\n        const { latitude, longitude } = position.coords;\n        setCurrentPosition([latitude, longitude]);\n        if (currentUser) {\n          const locationRef = doc(db, 'locations', currentUser.uid);\n          setDoc(locationRef, { \n            location: new GeoPoint(latitude, longitude),\n            updatedAt: serverTimestamp(),\n          });\n        }\n      },\n      (error) => {\n        console.error('Error watching position:', error);\n      },\n      {\n        enableHighAccuracy: true,\n        timeout: 5000,\n        maximumAge: 0,\n      }\n    );\n\n    return () => {\n      navigator.geolocation.clearWatch(watchId);\n    };\n  }, [currentUser]);\n  \n  const TripTabs = () => (\n    <div className=\"flex border-b border-gray-200 mb-4\">\n      <Button\n        className={`py-2 px-4 font-medium ${!showHistory ? 'text-primary border-b-2 border-primary' : 'text-secondary'}`}\n        onClick={() => setShowHistory(false)}\n      >\n        {STRINGS.VIAJES_ACTIVOS}\n      </Button>\n      <Button\n        className={`py-2 px-4 font-medium ${showHistory ? 'text-primary border-b-2 border-primary' : 'text-secondary'}`}\n        onClick={() => setShowHistory(true)}\n      >\n        {STRINGS.HISTORIAL}\n      </Button>\n    </div>\n  );\n  const [availableTrips, setAvailableTrips] = useState([]);\n  const [myTrips, setMyTrips] = useState([]);\n  const [tripHistory, setTripHistory] = useState([]);\n  const [showHistory, setShowHistory] = useState(false);\n  const [loading, setLoading] = useState(false);\n  const [origin, setOrigin] = useState(null);\n  const [destination, setDestination] = useState(null);\n  const [tripDetails, setTripDetails] = useState({\n    departureTime: '',\n    availableSeats: 1,\n    price: 0,\n    carModel: '',\n    carPlate: '',\n    estimatedDuration: ''\n  });\n  \n  const [map, setMap] = useState(null);\n  const [acceptedTrip, setAcceptedTrip] = useState(null);\n  const mapRef = useRef();\n  const mapInitialized = useRef(false);\n  const pendingCenter = useRef(null);\n  const [passengerLocation, setPassengerLocation] = useState(null);\n\n  useEffect(() => {\n    if (acceptedTrip?.passengerId) {\n      const passengerLocationRef = doc(db, 'locations', acceptedTrip.passengerId);\n      const unsubscribe = onSnapshot(passengerLocationRef, (doc) => {\n        if (doc.exists()) {\n          setPassengerLocation(doc.data().location);\n        }\n      });\n\n      return () => {\n        unsubscribe();\n      };\n    }\n  }, [acceptedTrip]);\n  \n  // Function to center the map on a specific location\n  const centerMapOnLocation = (lat, lng, zoom = 15) => {\n    if (!mapRef.current) {\n      console.log('Map reference not available, storing pending center:', { lat, lng });\n      pendingCenter.current = { lat, lng, zoom };\n      return false;\n    }\n\n    try {\n      console.log('Centering map to:', { lat, lng, zoom });\n      \n      // First set view immediately\n      mapRef.current.setView([lat, lng], zoom, {\n        animate: true,\n        duration: 0.5\n      });\n      \n      // Then do a smooth flyTo\n      setTimeout(() => {\n        if (mapRef.current) {\n          mapRef.current.flyTo([lat, lng], zoom, {\n            animate: true,\n            duration: 1.5,\n            easeLinearity: 0.5\n          });\n        }\n      }, 50);\n      \n      return true;\n    } catch (error) {\n      console.error('Error centering map:', error);\n      return false;\n    }\n  };\n\n  // Effect to handle map centering when acceptedTrip changes\n  useEffect(() => {\n    if (!acceptedTrip?.origin) return;\n    \n    const { lat, lng } = acceptedTrip.origin;\n    if (typeof lat !== 'number' || typeof lng !== 'number' || isNaN(lat) || isNaN(lng)) {\n      console.error('Invalid coordinates in acceptedTrip:', { lat, lng });\n      return;\n    }\n    \n    // Try to center immediately\n    const success = centerMapOnLocation(lat, lng);\n    \n    // If failed, try again after a short delay\n    if (!success) {\n      const timer = setTimeout(() => {\n        centerMapOnLocation(lat, lng);\n      }, 500);\n      return () => clearTimeout(timer);\n    }\n  }, [acceptedTrip]);\n\n  // Fetch available trips and subscribe to updates\n  useEffect(() => {\n    if (!currentUser) return;\n\n    // Load saved trip from localStorage if exists\n    const savedTrip = JSON.parse(localStorage.getItem('acceptedTrip'));\n    if (savedTrip?.origin) {\n      setAcceptedTrip(savedTrip);\n      // Center map on saved trip location\n      setTimeout(() => {\n        const { lat, lng } = savedTrip.origin;\n        centerMapOnLocation(lat, lng);\n      }, 500);\n    }\n\n    // Subscribe to real-time updates for available trips\n    const unsubscribeTrips = subscribeToTrips('searching',\n      (trips) => {\n        setAvailableTrips(trips);\n      },\n      (error) => {\n        console.error('Error fetching available trips:', error);\n      }\n    );\n\n    return () => {\n      if (typeof unsubscribeTrips === 'function') {\n        unsubscribeTrips();\n      }\n    };\n  }, [currentUser]);\n\n  // Fetch user's trips (both active and history)\n  useEffect(() => {\n    if (!currentUser) return;\n    \n    const fetchUserTrips = async () => {\n      try {\n        setLoading(true);\n        const [activeTrips, historyTrips] = await Promise.all([\n          getUserTrips(currentUser.uid, false), // Active trips\n          getUserTrips(currentUser.uid, true)   // History trips\n        ]);\n        \n        setMyTrips(activeTrips);\n        setTripHistory(historyTrips);\n      } catch (error) {\n        console.error('Error fetching user trips:', error);\n      } finally {\n        setLoading(false);\n      }\n    };\n    \n    fetchUserTrips();\n    \n    // Subscribe to real-time updates for active trips\n    const unsubscribe = subscribeToTripUpdates(\n      currentUser.uid,\n      (trips) => {\n        setMyTrips(trips.filter(trip => trip.status !== 'completed' && trip.status !== 'cancelled'));\n        // Update acceptedTrip if it's one of the updated trips\n        if (acceptedTrip) {\n          const updatedTrip = trips.find(t => t.id === acceptedTrip.id);\n          if (updatedTrip) {\n            setAcceptedTrip(updatedTrip);\n            localStorage.setItem('acceptedTrip', JSON.stringify(updatedTrip));\n          }\n        }\n      },\n      (error) => {\n        console.error('Error subscribing to trip updates:', error);\n      }\n    );\n    \n    return () => {\n      if (typeof unsubscribe === 'function') {\n        unsubscribe();\n      }\n    };\n  }, [currentUser, acceptedTrip]);\n\n  const handleLocationSelect = (latlng) => {\n    if (!origin) {\n      setOrigin({ ...latlng, name: STRINGS.ORIGEN });\n    } else if (!destination) {\n      setDestination({ ...latlng, name: STRINGS.DESTINO });\n    }\n  };\n\n  const handleInputChange = (e) => {\n    const { name, value } = e.target;\n    setTripDetails(prev => ({\n      ...prev,\n      [name]: name === 'availableSeats' || name === 'price' ? parseInt(value) || 0 : value\n    }));\n  };\n\n  const handleCreateTrip = async (e) => {\n    e.preventDefault();\n    \n    if (!origin || !destination) {\n      alert(STRINGS.SELECCIONAR_ORIGEN_DESTINO);\n      return;\n    }\n    \n    try {\n      setLoading(true);\n      \n      // Create a new trip using our createTrip function\n      await createTrip({\n        origin,\n        destination,\n        status: 'searching',\n        driverId: currentUser.uid,\n        driverName: currentUser.displayName || STRINGS.CONDUCTOR,\n        driverPhoto: currentUser.photoURL || '',\n        price: tripDetails.price || 0,\n        availableSeats: tripDetails.availableSeats || 1,\n        carModel: tripDetails.carModel || '',\n        carPlate: tripDetails.carPlate || '',\n        estimatedDuration: tripDetails.estimatedDuration || '',\n        departureTime: tripDetails.departureTime || new Date().toISOString()\n      });\n      \n      // Reset the form\n      setOrigin(null);\n      setDestination(null);\n      setTripDetails({\n        departureTime: '',\n        availableSeats: 1,\n        price: 0,\n        carModel: '',\n        carPlate: '',\n        estimatedDuration: ''\n      });\n      \n      alert('¡Viaje creado con éxito!');\n      \n    } catch (error) {\n      console.error('Error creating trip:', error);\n      alert(error.message || 'Error al crear el viaje. Por favor, inténtalo de nuevo.');\n    } finally {\n      setLoading(false);\n    }\n  };\n\n  // Effect to handle map centering when a trip is accepted\n  useEffect(() => {\n    if (acceptedTrip?.origin && mapRef.current) {\n      const { lat, lng } = acceptedTrip.origin;\n      mapRef.current.flyTo([lat, lng], 15, {\n        animate: true,\n        duration: 1.5\n      });\n    }\n  }, [acceptedTrip]);\n\n  const handleCompleteTrip = async (tripId) => {\n    if (!tripId) {\n      console.error('No trip ID provided for completion');\n      alert('No se pudo identificar el viaje a completar');\n      return;\n    }\n\n    // Find the trip in active trips\n    const tripToComplete = myTrips.find(trip => trip.id === tripId);\n    \n    if (!tripToComplete) {\n      console.error(`Trip ${tripId} not found in active trips`);\n      console.log('Available trip IDs:', myTrips.map(t => t.id));\n      alert('No se pudo encontrar el viaje activo para completar');\n      return;\n    }\n    \n    if (!window.confirm('¿Estás seguro de que deseas marcar este viaje como completado?')) {\n      return;\n    }\n    \n    try {\n      setLoading(true);\n      \n      // Update the trip status to completed\n      await updateTripStatus(tripId, 'completed');\n      \n      // If this was the currently accepted trip, clear it\n      if (acceptedTrip && acceptedTrip.id === tripId) {\n        setAcceptedTrip(null);\n        localStorage.removeItem('acceptedTrip');\n      }\n      \n      // Show success message\n      alert('¡Viaje completado con éxito!');\n      \n      // Refresh the trips list\n      const [activeTrips, historyTrips] = await Promise.all([\n        getUserTrips(currentUser.uid, false), // Active trips\n        getUserTrips(currentUser.uid, true)   // History trips\n      ]);\n      \n      setMyTrips(activeTrips);\n      setTripHistory(historyTrips);\n      \n    } catch (error) {\n      console.error('Error completing trip:', error);\n      alert(error.message || 'Error al completar el viaje. Por favor, inténtalo de nuevo.');\n      \n      // Clean up local state if the trip doesn't exist on the server\n      if (error.code === 'not-found' || error.message.includes('no existe')) {\n        console.log('Cleaning up local state for non-existent trip');\n        setMyTrips(prev => prev.filter(trip => trip.id !== tripId));\n        if (acceptedTrip?.id === tripId) {\n          setAcceptedTrip(null);\n          localStorage.removeItem('acceptedTrip');\n        }\n      }\n    } finally {\n      setLoading(false);\n    }\n  };\n\n  const formatDate = (dateString) => {\n    if (!dateString) return 'No especificada';\n    try {\n      const options = { \n        weekday: 'long', \n        year: 'numeric', \n        month: 'long', \n        day: 'numeric', \n        hour: '2-digit', \n        minute: '2-digit' \n      };\n      const date = new Date(dateString);\n      return isNaN(date.getTime()) ? 'Fecha inválida' : date.toLocaleDateString('es-ES', options);\n    } catch (error) {\n      console.error('Error formatting date:', error);\n      return 'Fecha inválida';\n    }\n  };\n\n  const handleMapLoad = (mapInstance) => {\n    console.log('Map instance loaded');\n    mapRef.current = mapInstance;\n    setMap(mapInstance);\n    mapInitialized.current = true;\n    \n    // If we have a pending center from before the map was ready, apply it now\n    if (pendingCenter.current) {\n      const { lat, lng, zoom } = pendingCenter.current;\n      centerMapOnLocation(lat, lng, zoom);\n      pendingCenter.current = null;\n    }\n    // Otherwise, if we have an accepted trip, center on it\n    else if (acceptedTrip?.origin) {\n      const { lat, lng } = acceptedTrip.origin;\n      if (typeof lat === 'number' && typeof lng === 'number') {\n        centerMapOnLocation(lat, lng);\n      }\n    }\n    \n    // Add a one-time moveend listener to log when the map has finished moving\n    const handleMoveEnd = () => {\n      if (mapRef.current) {\n        const center = mapRef.current.getCenter();\n        console.log('Map moved to:', { \n          lat: center.lat, \n          lng: center.lng,\n          zoom: mapRef.current.getZoom()\n        });\n      }\n    };\n    \n    mapInstance.on('moveend', handleMoveEnd);\n    \n    // Cleanup\n    return () => {\n      mapInstance.off('moveend', handleMoveEnd);\n    };\n  };\n\n\n  return (\n    <div className=\"min-h-screen bg-light\">\n      <div className=\"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-8\">\n        <div className=\"grid grid-cols-1 lg:grid-cols-3 gap-8\">\n          {/* Left sidebar */}\n          <div className=\"lg:col-span-1 space-y-6\">\n            <div className=\"bg-white rounded-lg shadow-md p-6\">\n              <h2 className=\"text-xl font-bold text-dark mb-4\">{STRINGS.PANEL_DEL_CONDUCTOR}</h2>\n              \n              <div className=\"flex border-b mb-4\">\n                <Button \n                  className={`flex-1 py-2 font-medium ${activeTab === 'available' ? 'text-primary border-b-2 border-primary' : 'text-secondary'}`}\n                  onClick={() => setActiveTab('available')}\n                >\n                  {STRINGS.VIAJES_DISPONIBLES}\n                </Button>\n                <Button \n                  className={`flex-1 py-2 font-medium ${activeTab === 'my-trips' ? 'text-primary border-b-2 border-primary' : 'text-secondary'}`}\n                  onClick={() => setActiveTab('my-trips')}\n                >\n                  {STRINGS.MIS_VIAJES}\n                </Button>\n                <Button \n                  className={`flex-1 py-2 font-medium ${activeTab === 'create-trip' ? 'text-primary border-b-2 border-primary' : 'text-secondary'}`}\n                  onClick={() => setActiveTab('create-trip')}\n                >\n                  <FaPlus className=\"inline mr-1\" />\n                </Button>\n              </div>\n              \n              {/* Available Trips Tab */}\n              {activeTab === 'available' && (\n                <div className=\"space-y-4\">\n                  <h3 className=\"font-medium text-dark\">{STRINGS.SOLICITUDES_DE_VIAJE}</h3>\n                  {availableTrips.length === 0 ? (\n                    <p className=\"text-sm text-secondary py-4 text-center\">{STRINGS.NO_HAY_VIAJES_DISPONIBLES}</p>\n                  ) : (\n                    <div className=\"space-y-4\">\n                      {availableTrips.map((trip) => (\n                        <div key={trip.id} className=\"border rounded-lg p-4 space-y-3\">\n                          <div className=\"flex items-center\">\n                            <FaMapMarkerAlt className=\"text-danger mr-2 w-4\" />\n                            <span className=\"truncate\">{trip.origin?.name || STRINGS.ORIGEN_NO_ESPECIFICADO}</span>\n                          </div>\n                          <div className=\"flex items-center\">\n                            <FaMapMarkerAlt className=\"text-success mr-2 w-4\" />\n                            <span className=\"truncate\">{trip.destination?.name || STRINGS.DESTINO_NO_ESPECIFICADO}</span>\n                          </div>\n                          <div className=\"flex items-center text-secondary\">\n                            <FaClock className=\"mr-2 w-4\" />\n                            <span>{formatDate(trip.departureTime)}</span>\n                          </div>\n                          <div className=\"flex items-center text-secondary\">\n                            <FaUser className=\"mr-2 w-4\" />\n                            <span>{trip.passengers || 1} {trip.passengers > 1 ? STRINGS.PASAJEROS : STRINGS.PASAJERO}</span>\n                          </div>\n                          <div className=\"flex items-center text-lg font-semibold text-primary\">\n                            <FaMoneyBillWave className=\"mr-2\" />\n                            ${(trip.price || 0).toLocaleString()}\n                          </div>\n                          <Button\n                            onClick={() => handleAcceptTrip(trip.id)}\n                            disabled={loading}\n                            className=\"w-full bg-success text-white py-2 rounded-lg font-medium hover:bg-success-dark transition-colors flex items-center justify-center\"\n                          >\n                            {loading ? (\n                              <>\n                                <svg className=\"animate-spin -ml-1 mr-2 h-4 w-4 text-white\" xmlns=\"http://www.w3.org/2000/svg\" fill=\"none\" viewBox=\"0 0 24 24\">\n                                  <circle className=\"opacity-25\" cx=\"12\" cy=\"12\" r=\"10\" stroke=\"currentColor\" strokeWidth=\"4\"></circle>\n                                  <path className=\"opacity-75\" fill=\"currentColor\" d=\"M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z\"></path>\n                                </svg>\n                                {STRINGS.PROCESANDO}\n                              </>\n                            ) : (\n                              <>\n                                <FaCheck className=\"mr-2\" />\n                                {STRINGS.ACEPTAR_VIAJE}\n                              </>\n                            )}\n                          </Button>\n                        </div>\n                      ))}\n                    </div>\n                  )}\n                </div>\n              )}\n              \n              {/* My Trips Tab */}\n              {activeTab === 'my-trips' && (\n                <div className=\"space-y-4\">\n                  <TripTabs />\n                  \n                  {!showHistory ? (\n                    // Active trips\n                    myTrips.length > 0 ? (\n                      myTrips.map((trip) => (\n                        <div key={trip.id} className=\"border rounded-lg p-4 hover:shadow-md transition-shadow\">\n                          <div className=\"flex justify-between items-start mb-3\">\n                            <div>\n                              <h4 className=\"font-medium text-dark\">\n                                {trip.origin?.name?.split(',')[0] || STRINGS.ORIGEN} → {trip.destination?.name?.split(',')[0] || STRINGS.DESTINO}\n                              </h4>\n                              <span className={`inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-medium ${\n                                trip.status === 'accepted' \n                                  ? 'bg-primary text-white' \n                                  : trip.status === 'completed'\n                                    ? 'bg-secondary text-white'\n                                    : trip.status === 'in_progress'\n                                      ? 'bg-warning text-white'\n                                      : 'bg-success text-white'\n                              }`}>\n                                {trip.status === 'accepted' \n                                  ? STRINGS.ACEPTADO \n                                  : trip.status === 'completed' \n                                    ? STRINGS.COMPLETADO \n                                    : trip.status === 'in_progress'\n                                      ? STRINGS.EN_CURSO\n                                      : STRINGS.DISPONIBLE_MAYUS}\n                              </span>\n                            </div>\n                            <div className=\"text-right\">\n                              <div className=\"text-xl font-bold text-primary\">${(trip.price || 0).toLocaleString()}</div>\n                              <div className=\"text-sm text-secondary\">\n                                {trip.passengers} {trip.passengers > 1 ? STRINGS.PASAJEROS : STRINGS.PASAJERO}\n                              </div>\n                            </div>\n                          </div>\n                          \n                          <div className=\"space-y-2 text-sm mb-4\">\n                            <div className=\"flex items-center\">\n                              <FaMapMarkerAlt className=\"text-danger mr-2 w-4\" />\n                              <span className=\"truncate\">{trip.origin?.name || STRINGS.ORIGEN_NO_ESPECIFICADO}</span>\n                            </div>\n                            <div className=\"flex items-center\">\n                              <FaMapMarkerAlt className=\"text-success mr-2 w-4\" />\n                              <span className=\"truncate\">{trip.destination?.name || STRINGS.DESTINO_NO_ESPECIFICADO}</span>\n                            </div>\n                            <div className=\"flex items-center text-secondary\">\n                              <FaClock className=\"mr-2 w-4\" />\n                              <span>{formatDate(trip.departureTime)}</span>\n                            </div>\n                            {trip.carModel && (\n                              <div className=\"flex items-center text-secondary\">\n                                <FaCar className=\"mr-2 w-4\" />\n                                <span>{trip.carModel} {trip.carPlate ? `• ${trip.carPlate}` : ''}</span>\n                              </div>\n                            )}\n                            {trip.passengerName && (\n                              <div className=\"mt-2 pt-2 border-t\">\n                                <p className=\"font-medium text-sm mb-1\">{STRINGS.PASAJERO}:</p>\n                                <div className=\"flex items-center text-sm text-dark\">\n                                  <FaUser className=\"mr-2 w-4 text-secondary\" />\n                                  <span>{trip.passengerName}</span>\n                                </div>\n                              </div>\n                            )}\n                          </div>\n                          \n                          {trip.status === 'accepted' && (\n                            <div className=\"flex gap-2\">\n                              <Button\n                                onClick={() => handleCompleteTrip(trip.id)}\n                                disabled={loading}\n                                className=\"flex-1 bg-success text-white py-2 rounded-lg font-medium hover:bg-success-dark transition-colors\"\n                              >\n                                {loading ? STRINGS.PROCESANDO : STRINGS.COMPLETAR_VIAJE}\n                              </Button>\n                            </div>\n                          )}\n                        </div>\n                      ))\n                    ) : (\n                      <div className=\"text-center py-8 text-secondary\">\n                        <p>{STRINGS.NO_TIENES_VIAJES_ACTIVOS}</p>\n                        <Button \n                          className=\"mt-4 text-primary hover:text-primary-dark font-medium\"\n                          onClick={() => setActiveTab('create-trip')}\n                        >\n                          {STRINGS.CREAR_UN_NUEVO_VIAJE}\n                        </Button>\n                      </div>\n                    )\n                  ) : (\n                    // Trip history\n                    tripHistory.length > 0 ? (\n                      tripHistory.map((trip) => (\n                        <div key={trip.id} className=\"bg-white rounded-lg shadow-md p-4 border-l-4 border-success\">\n                          <div className=\"flex justify-between items-start\">\n                            <div>\n                              <h3 className=\"font-medium text-dark\">\n                                {trip.origin?.name || STRINGS.ORIGEN_DESCONOCIDO} → {trip.destination?.name || STRINGS.DESTINO_DESCONOCIDO}\n                              </h3>\n                              <p className=\"text-sm text-secondary\">\n                                {trip.passengerName ? `${STRINGS.PASAJERO}: ${trip.passengerName}` : STRINGS.PASAJERO_NO_ESPECIFICADO}\n                              </p>\n                              <p className=\"text-sm text-secondary\">\n                                {STRINGS.PRECIO}${trip.price || 'No especificado'}\n                              </p>\n                              {trip.completedAt && (\n                                <p className=\"text-xs text-light mt-1\">\n                                  {STRINGS.COMPLETADO_PUNTOS}{formatDate(trip.completedAt, true)}\n                                </p>\n                              )}\n                            </div>\n                            <span className=\"inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-medium bg-success text-white\">\n                              {STRINGS.COMPLETADO}\n                            </span>\n                          </div>\n                        </div>\n                      ))\n                    ) : (\n                      <div className=\"text-center py-8\">\n                        <p className=\"text-secondary\">{STRINGS.AUN_NO_TIENES_VIAJES_COMPLETADOS}</p>\n                      </div>\n                    )\n                  )}\n                </div>\n              )}\n              \n              {/* Create Trip Tab */}\n              {activeTab === 'create-trip' && (\n                <form onSubmit={handleCreateTrip}>\n                  <h3 className=\"font-medium text-dark mb-4\">{STRINGS.CREAR_NUEVO_VIAJE}</h3>\n                  \n                  <div className=\"space-y-4\">\n                    <div>\n                      <label className=\"block text-sm font-medium text-dark mb-1\">{STRINGS.ORIGEN}</label>\n                      <div className=\"flex items-center bg-light rounded-lg p-3\">\n                        <FaMapMarkerAlt className=\"text-danger mr-2\" />\n                        <span>{origin?.name || STRINGS.SELECCIONA_EN_MAPA}</span>\n                      </div>\n                    </div>\n                    \n                    <div>\n                      <label className=\"block text-sm font-medium text-dark mb-1\">{STRINGS.DESTINO}</label>\n                      <div className=\"flex items-center bg-light rounded-lg p-3\">\n                        <FaMapMarkerAlt className=\"text-success mr-2\" />\n                        <span>{destination?.name || STRINGS.SELECCIONA_EN_MAPA}</span>\n                      </div>\n                    </div>\n                    \n                    <div>\n                      <label htmlFor=\"departureTime\" className=\"block text-sm font-medium text-dark mb-1\">\n                        {STRINGS.FECHA_Y_HORA_DE_SALIDA}\n                      </label>\n                      <input\n                        type=\"datetime-local\"\n                        id=\"departureTime\"\n                        name=\"departureTime\"\n                        value={tripDetails.departureTime}\n                        onChange={handleInputChange}\n                        className=\"w-full px-3 py-2 border border-gray-300 rounded-md shadow-sm focus:outline-none focus:ring-primary focus:border-primary\"\n                        required\n                      />\n                    </div>\n                    \n                    <div>\n                      <label htmlFor=\"availableSeats\" className=\"block text-sm font-medium text-dark mb-1\">\n                        {STRINGS.ASIENTOS_DISPONIBLES_MAYUS}\n                      </label>\n                      <input\n                        type=\"number\"\n                        id=\"availableSeats\"\n                        name=\"availableSeats\"\n                        min=\"1\"\n                        max=\"10\"\n                        value={tripDetails.availableSeats}\n                        onChange={handleInputChange}\n                        className=\"w-full px-3 py-2 border border-gray-300 rounded-md shadow-sm focus:outline-none focus:ring-primary focus:border-primary\"\n                        required\n                      />\n                    </div>\n                    \n                    <div>\n                      <label htmlFor=\"price\" className=\"block text-sm font-medium text-dark mb-1\">\n                        {STRINGS.PRECIO_POR_ASIENTO}\n                      </label>\n                      <div className=\"mt-1 relative rounded-md shadow-sm\">\n                        <div className=\"absolute inset-y-0 left-0 pl-3 flex items-center pointer-events-none\">\n                          <span className=\"text-secondary sm:text-sm\">$</span>\n                        </div>\n                        <input\n                          type=\"number\"\n                          id=\"price\"\n                          name=\"price\"\n                          min=\"0\"\n                          value={tripDetails.price}\n                          onChange={handleInputChange}\n                          className=\"w-full pl-7 pr-3 py-2 border border-gray-300 rounded-md shadow-sm focus:outline-none focus:ring-primary focus:border-primary\"\n                          required\n                        />\n                      </div>\n                    </div>\n                    \n                    <div>\n                      <label htmlFor=\"carModel\" className=\"block text-sm font-medium text-dark mb-1\">\n                        {STRINGS.MODELO_DEL_VEHICULO}\n                      </label>\n                      <input\n                        type=\"text\"\n                        id=\"carModel\"\n                        name=\"carModel\"\n                        value={tripDetails.carModel}\n                        onChange={handleInputChange}\n                        className=\"w-full px-3 py-2 border border-gray-300 rounded-md shadow-sm focus:outline-none focus:ring-primary focus:border-primary\"\n                        placeholder={STRINGS.EJ_TOYOTA_COROLLA}\n                        required\n                      />\n                    </div>\n                    \n                    <div>\n                      <label htmlFor=\"carPlate\" className=\"block text-sm font-medium text-dark mb-1\">\n                        {STRINGS.PLACA_DEL_VEHICULO}\n                      </label>\n                      <input\n                        type=\"text\"\n                        id=\"carPlate\"\n                        name=\"carPlate\"\n                        value={tripDetails.carPlate}\n                        onChange={handleInputChange}\n                        className=\"w-full px-3 py-2 border border-gray-300 rounded-md shadow-sm focus:outline-none focus:ring-primary focus:border-primary\"\n                        placeholder={STRINGS.EJ_ABC123}\n                        required\n                      />\n                    </div>\n                    \n                    <div>\n                      <label htmlFor=\"estimatedDuration\" className=\"block text-sm font-medium text-dark mb-1\">\n                        {STRINGS.DURACION_ESTIMADA}\n                      </label>\n                      <input\n                        type=\"text\"\n                        id=\"estimatedDuration\"\n                        name=\"estimatedDuration\"\n                        value={tripDetails.estimatedDuration}\n                        onChange={handleInputChange}\n                        className=\"w-full px-3 py-2 border border-gray-300 rounded-md shadow-sm focus:outline-none focus:ring-primary focus:border-primary\"\n                        placeholder={STRINGS.EJ_45_MIN}\n                      />\n                    </div>\n                    \n                    <div className=\"pt-2\">\n                      <Button\n                        type=\"submit\"\n                        disabled={!origin || !destination || loading}\n                        className={`w-full bg-primary text-white py-3 px-4 rounded-lg font-medium flex items-center justify-center ${\n                          (!origin || !destination || loading) ? 'opacity-50 cursor-not-allowed' : 'hover:bg-primary-dark'\n                        }`}\n                      >\n                        {loading ? (\n                          <>\n                            <svg className=\"animate-spin -ml-1 mr-2 h-5 w-5 text-white\" xmlns=\"http://www.w3.org/2000/svg\" fill=\"none\" viewBox=\"0 0 24 24\">\n                              <circle className=\"opacity-25\" cx=\"12\" cy=\"12\" r=\"10\" stroke=\"currentColor\" strokeWidth=\"4\"></circle>\n                              <path className=\"opacity-75\" fill=\"currentColor\" d=\"M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z\"></path>\n                            </svg>\n                            {STRINGS.CREANDO_VIAJE}\n                          </>\n                        ) : (\n                          STRINGS.PUBLICAR_VIAJE\n                        )}\n                      </Button>\n                    </div>\n                  </div>\n                </form>\n              )}\n            </div>\n          </div>\n          \n          {/* Map - Added responsive height and full width on mobile */}\n          <div className=\"lg:col-span-2 bg-white rounded-xl shadow-md overflow-hidden w-full h-96 lg:h-full\">\n            <div className=\"w-full h-full\">\n              <MapContainer \n                  center={currentPosition || [0, 0]} \n                  zoom={currentPosition ? 13 : 2} \n                  style={{ height: '100%', width: '100%', minHeight: '400px' }}\n                  zoomControl={true}\n                  whenCreated={handleMapLoad}\n                >\n                <TileLayer\n                  url=\"https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png\"\n                  attribution='&copy; <a href=\"https://www.openstreetmap.org/copyright\">OpenStreetMap</a> contributors'\n                />\n\n                {/* Passenger Location Marker */}\n                {passengerLocation && (\n                  <Marker \n                    position={[passengerLocation.latitude, passengerLocation.longitude]}\n                    icon={passengerIcon}\n                  >\n                    <Popup>\n                      <div className=\"text-sm\">\n                        <div className=\"font-medium\">{STRINGS.RECOGER_A}{acceptedTrip.passengerName || STRINGS.EL_PASAJERO}</div>\n                        <div>{acceptedTrip.origin.name || STRINGS.UBICACION_DEL_PASAJERO}</div>\n                      </div>\n                    </Popup>\n                  </Marker>\n                )}\n                \n                {/* Origin Marker */}\n                {origin && (\n                  <Marker \n                    position={[origin.lat, origin.lng]} \n                    icon={defaultIcon}\n                  >\n                    <Popup>{STRINGS.ORIGEN_PUNTOS}{origin.name || STRINGS.UBICACION_DE_RECOGIDA}</Popup>\n                  </Marker>\n                )}\n                \n                {/* Destination Marker */}\n                {destination && (\n                  <Marker \n                    position={[destination.lat, destination.lng]} \n                    icon={defaultIcon}\n                  >\n                    <Popup>{STRINGS.DESTINO_PUNTOS}{destination.name || STRINGS.UBICACION_DE_DESTINO}</Popup>\n                  </Marker>\n                )}\n                \n                {/* Available Trips Markers */}\n                {activeTab === 'available' && availableTrips.map((trip) => (\n                  <Marker \n                    key={trip.id}\n                    position={[trip.origin.lat, trip.origin.lng]} \n                    icon={defaultIcon}\n                  >\n                    <Popup>\n                      <div className=\"text-sm\">\n                        <div className=\"font-medium\">{STRINGS.SOLICITUD_DE_VIAJE}</div>\n                        <div>{STRINGS.DE}{trip.origin.name || STRINGS.ORIGEN}</div>\n                        <div>{STRINGS.A}{trip.destination.name || STRINGS.DESTINO}</div>\n                        <div>{STRINGS.PASAJEROS_PUNTOS}{trip.passengers || 1}</div>\n                        <div>{STRINGS.PRECIO}${(trip.price || 0).toLocaleString()}</div>\n                        <Button\n                          onClick={() => handleAcceptTrip(trip.id)}\n                          className=\"mt-2 w-full bg-success text-white py-1 px-2 rounded text-xs font-medium hover:bg-success-dark\"\n                        >\n                          {STRINGS.ACEPTAR_VIAJE}\n                        </Button>\n                      </div>\n                    </Popup>\n                  </Marker>\n                ))}\n                \n                {/* Location Selector */}\n                {activeTab === 'create-trip' && (\n                  <LocationSelector onSelect={handleLocationSelect} />\n                )}\n              </MapContainer>\n            </div>\n          </div>\n        </div>\n      </div>\n    </div>\n  );\n}\n\nexport default Driver;"],"names":["defaultIcon","L","passengerIcon","LocationSelector","onSelect","map","useMap","useEffect","handleClick","e","Driver","currentUser","logout","useAuth","useNavigate","activeTab","setActiveTab","useState","currentPosition","setCurrentPosition","watchId","position","latitude","longitude","locationRef","doc","db","setDoc","GeoPoint","serverTimestamp","error","TripTabs","jsxs","jsx","Button","showHistory","setShowHistory","STRINGS","availableTrips","setAvailableTrips","myTrips","setMyTrips","tripHistory","setTripHistory","loading","setLoading","origin","setOrigin","destination","setDestination","tripDetails","setTripDetails","setMap","acceptedTrip","setAcceptedTrip","mapRef","useRef","mapInitialized","pendingCenter","passengerLocation","setPassengerLocation","passengerLocationRef","unsubscribe","onSnapshot","centerMapOnLocation","lat","lng","zoom","timer","savedTrip","unsubscribeTrips","subscribeToTrips","trips","activeTrips","historyTrips","getUserTrips","subscribeToTripUpdates","trip","updatedTrip","t","handleLocationSelect","latlng","handleInputChange","name","value","prev","handleCreateTrip","createTrip","handleCompleteTrip","tripId","updateTripStatus","formatDate","dateString","options","date","handleMapLoad","mapInstance","handleMoveEnd","center","FaPlus","FaMapMarkerAlt","FaClock","FaUser","FaMoneyBillWave","Fragment","FaCheck","_a","_b","_d","_c","FaCar","MapContainer","TileLayer","Marker","Popup"],"mappings":"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"}