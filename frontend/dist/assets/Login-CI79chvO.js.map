{"version":3,"file":"Login-CI79chvO.js","sources":["../../src/pages/Login.jsx"],"sourcesContent":["import React, { useState, useRef, useEffect } from 'react';\nimport { useNavigate, Link } from 'react-router-dom';\nimport { useAuth } from '../contexts/AuthContext';\nimport { FaGoogle, FaFacebook, FaEnvelope, FaUser, FaLock, FaUserTie, FaUserShield, FaSpinner } from 'react-icons/fa';\n\nexport default function Login() {\n  const [email, setEmail] = useState('');\n  const [password, setPassword] = useState('');\n  const [displayName, setDisplayName] = useState('');\n  const [role, setRole] = useState('passenger');\n  const [isLogin, setIsLogin] = useState(true);\n  const { \n    login, \n    signup, \n    loginWithGoogle, \n    loginWithFacebook,\n    resetPassword,\n    loading,\n    error,\n    clearError\n  } = useAuth();\n  \n  const navigate = useNavigate();\n  const emailRef = useRef();\n  const passwordRef = useRef();\n  const nameRef = useRef();\n  \n  // Clear any existing errors when switching between login/register\n  useEffect(() => {\n    if (error) clearError();\n  }, [isLogin]);\n\n  async function handleLogin(e) {\n    e.preventDefault();\n    \n    if (!email || !password) {\n      return; // El error se manejará en el AuthContext\n    }\n    \n    try {\n      await login(email, password);\n      // La redirección se manejará con el listener de autenticación\n    } catch (error) {\n      // El error ya está manejado en el AuthContext\n      console.error('Login error:', error);\n    }\n  }\n\n  async function handleRegister(e) {\n    e.preventDefault();\n    \n    if (password.length < 6) {\n      return; // El error se manejará en el AuthContext\n    }\n    \n    if (!displayName) {\n      return; // El error se manejará en el AuthContext\n    }\n    \n    try {\n      await signup(email, password, displayName, role);\n      // Mostrar mensaje de éxito\n      setIsLogin(true);\n    } catch (error) {\n      console.error('Registration error:', error);\n    }\n  }\n  \n  async function handleGoogleSignIn() {\n    try {\n      await loginWithGoogle();\n      // La redirección se manejará con el listener de autenticación\n    } catch (error) {\n      console.error('Google sign in error:', error);\n    }\n  }\n  \n  async function handleFacebookSignIn() {\n    try {\n      await loginWithFacebook();\n      // La redirección se manejará con el listener de autenticación\n    } catch (error) {\n      console.error('Facebook sign in error:', error);\n    }\n  }\n  \n  async function handlePasswordReset() {\n    if (!email) {\n      return; // El error se manejará en el AuthContext\n    }\n    \n    try {\n      await resetPassword(email);\n      // El mensaje de éxito se manejará en el AuthContext\n    } catch (error) {\n      console.error('Password reset error:', error);\n    }\n  }\n  \n  function toggleAuthMode() {\n    setError('');\n    setIsLogin(!isLogin);\n  }\n\n  return (\n    <div className=\"min-h-screen flex items-center justify-center bg-gradient-to-br from-blue-50 to-indigo-100 p-4\">\n      <div className=\"w-full max-w-md\">\n        <div className=\"bg-white rounded-xl shadow-2xl p-8\">\n          <h2 className=\"text-3xl font-bold text-center text-gray-800 mb-8\">\n            {isLogin ? 'Iniciar Sesión' : 'Crear Cuenta'}\n          </h2>\n          \n          {error && (\n            <div className=\"mb-6 p-4 bg-red-50 text-red-700 rounded-lg text-sm flex items-start\">\n              <svg className=\"w-5 h-5 mr-2 mt-0.5 flex-shrink-0\" fill=\"currentColor\" viewBox=\"0 0 20 20\">\n                <path fillRule=\"evenodd\" d=\"M10 18a8 8 0 100-16 8 8 0 000 16zM8.707 7.293a1 1 0 00-1.414 1.414L8.586 10l-1.293 1.293a1 1 0 101.414 1.414L10 11.414l1.293 1.293a1 1 0 001.414-1.414L11.414 10l1.293-1.293a1 1 0 00-1.414-1.414L10 8.586 8.707 7.293z\" clipRule=\"evenodd\" />\n              </svg>\n              <span>{error}</span>\n            </div>\n          )}\n          \n          {loading && (\n            <div className=\"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50\">\n              <div className=\"bg-white p-6 rounded-lg shadow-xl flex flex-col items-center\">\n                <FaSpinner className=\"animate-spin text-blue-600 text-3xl mb-4\" />\n                <p className=\"text-gray-700\">Procesando, por favor espera...</p>\n              </div>\n            </div>\n          )}\n          \n          {/* Social Login Buttons */}\n          <div className=\"space-y-3 mb-6\">\n            <button\n              type=\"button\"\n              onClick={handleGoogleSignIn}\n              disabled={loading}\n              className=\"w-full flex items-center justify-center gap-3 bg-white border border-gray-300 text-gray-700 font-medium py-3 px-4 rounded-lg hover:bg-gray-50 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-blue-500 transition-all disabled:opacity-70 disabled:cursor-not-allowed\"\n            >\n              <FaGoogle className=\"text-red-500 text-xl\" />\n              Continuar con Google\n            </button>\n            \n            <button\n              type=\"button\"\n              onClick={handleFacebookSignIn}\n              disabled={loading}\n              className=\"w-full flex items-center justify-center gap-3 bg-[#1877F2] text-white font-medium py-3 px-4 rounded-lg hover:bg-[#166FE5] focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-[#166FE5] transition-all disabled:opacity-70 disabled:cursor-not-allowed\"\n            >\n              <FaFacebook className=\"text-white text-xl\" />\n              Continuar con Facebook\n            </button>\n          </div>\n          \n          {/* Divisor */}\n          <div className=\"relative my-6\">\n            <div className=\"absolute inset-0 flex items-center\">\n              <div className=\"w-full border-t border-gray-300\"></div>\n            </div>\n            <div className=\"relative flex justify-center text-sm\">\n              <span className=\"px-2 bg-white text-gray-500\">O continúa con</span>\n            </div>\n          </div>\n          \n          {/* Formulario */}\n          <form onSubmit={isLogin ? handleLogin : handleRegister} className=\"space-y-4\">\n            {!isLogin && (\n              <div>\n                <label htmlFor=\"displayName\" className=\"block text-sm font-medium text-gray-700 mb-1\">\n                  Nombre completo\n                </label>\n                <div className=\"relative\">\n                  <div className=\"absolute inset-y-0 left-0 pl-3 flex items-center pointer-events-none\">\n                    <FaUser className=\"text-gray-400\" />\n                  </div>\n                  <input\n                    type=\"text\"\n                    id=\"displayName\"\n                    ref={nameRef}\n                    value={displayName}\n                    onChange={(e) => setDisplayName(e.target.value)}\n                    className=\"w-full pl-10 pr-4 py-2 border border-gray-300 rounded-lg focus:ring-blue-500 focus:border-blue-500 disabled:bg-gray-50 disabled:cursor-not-allowed\"\n                    placeholder=\"Tu nombre completo\"\n                    required={!isLogin}\n                    disabled={loading}\n                  />\n                </div>\n              </div>\n            )}\n            \n            <div>\n              <label htmlFor=\"email\" className=\"block text-sm font-medium text-gray-700 mb-1\">\n                Correo electrónico\n              </label>\n              <div className=\"relative\">\n                <div className=\"absolute inset-y-0 left-0 pl-3 flex items-center pointer-events-none\">\n                  <FaEnvelope className=\"text-gray-400\" />\n                </div>\n                <input\n                  type=\"email\"\n                  id=\"email\"\n                  ref={emailRef}\n                  value={email}\n                  onChange={(e) => setEmail(e.target.value)}\n                  className=\"w-full pl-10 pr-4 py-2 border border-gray-300 rounded-lg focus:ring-blue-500 focus:border-blue-500 disabled:bg-gray-50 disabled:cursor-not-allowed\"\n                  placeholder=\"tu@email.com\"\n                  required\n                  disabled={loading}\n                />\n              </div>\n            </div>\n            \n            <div>\n              <div className=\"flex items-center justify-between mb-1\">\n                <label htmlFor=\"password\" className=\"block text-sm font-medium text-gray-700\">\n                  Contraseña\n                </label>\n                {isLogin && (\n                  <button\n                    type=\"button\"\n                    onClick={handlePasswordReset}\n                    disabled={loading}\n                    className=\"text-xs text-blue-600 hover:text-blue-800 focus:outline-none disabled:opacity-50 disabled:cursor-not-allowed\"\n                  >\n                    ¿Olvidaste tu contraseña?\n                  </button>\n                )}\n              </div>\n              <div className=\"relative\">\n                <div className=\"absolute inset-y-0 left-0 pl-3 flex items-center pointer-events-none\">\n                  <FaLock className=\"text-gray-400\" />\n                </div>\n                <input\n                  type=\"password\"\n                  id=\"password\"\n                  ref={passwordRef}\n                  value={password}\n                  onChange={(e) => setPassword(e.target.value)}\n                  className=\"w-full pl-10 pr-4 py-2 border border-gray-300 rounded-lg focus:ring-blue-500 focus:border-blue-500 disabled:bg-gray-50 disabled:cursor-not-allowed\"\n                  placeholder=\"••••••••\"\n                  required\n                  minLength={isLogin ? 1 : 6}\n                  disabled={loading}\n                />\n              </div>\n            </div>\n            \n            {!isLogin && (\n              <div>\n                <label className=\"block text-sm font-medium text-gray-700 mb-1\">\n                  Tipo de cuenta\n                </label>\n                <div className=\"grid grid-cols-2 gap-3\">\n                  <button\n                    type=\"button\"\n                    onClick={() => setRole('passenger')}\n                    disabled={loading}\n                    className={`flex items-center justify-center gap-2 py-2 px-4 rounded-lg border ${\n                      role === 'passenger' \n                        ? 'bg-blue-50 border-blue-500 text-blue-700' \n                        : 'border-gray-300 text-gray-700 hover:bg-gray-50'\n                    } disabled:opacity-50 disabled:cursor-not-allowed`}\n                  >\n                    <FaUserTie />\n                    <span>Pasajero</span>\n                  </button>\n                  <button\n                    type=\"button\"\n                    onClick={() => setRole('driver')}\n                    disabled={loading}\n                    className={`flex items-center justify-center gap-2 py-2 px-4 rounded-lg border ${\n                      role === 'driver' \n                        ? 'bg-blue-50 border-blue-500 text-blue-700' \n                        : 'border-gray-300 text-gray-700 hover:bg-gray-50'\n                    } disabled:opacity-50 disabled:cursor-not-allowed`}\n                  >\n                    <FaUserShield />\n                    <span>Conductor</span>\n                  </button>\n                </div>\n              </div>\n            )}\n            \n            <button\n              type=\"submit\"\n              disabled={loading}\n              className=\"w-full flex items-center justify-center gap-2 bg-blue-600 text-white py-2 px-4 rounded-lg hover:bg-blue-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-blue-500 transition-colors disabled:opacity-70 disabled:cursor-not-allowed\"\n            >\n              {loading ? (\n                <>\n                  <FaSpinner className=\"animate-spin\" />\n                  Procesando...\n                </>\n              ) : isLogin ? (\n                'Iniciar sesión'\n              ) : (\n                'Registrarse'\n              )}\n            </button>\n          </form>\n          \n          <div className=\"mt-6 text-center text-sm text-gray-600\">\n            {isLogin ? '¿No tienes una cuenta? ' : '¿Ya tienes una cuenta? '}\n            <button\n              type=\"button\"\n              onClick={toggleAuthMode}\n              disabled={loading}\n              className=\"text-blue-600 font-medium hover:text-blue-800 hover:underline focus:outline-none disabled:opacity-50 disabled:cursor-not-allowed\"\n            >\n              {isLogin ? 'Regístrate' : 'Inicia sesión'}\n            </button>\n          </div>\n          \n          {/* Loading overlay for form submission */}\n          {loading && (\n            <div className=\"fixed inset-0 bg-black bg-opacity-30 flex items-center justify-center z-40\">\n              <div className=\"bg-white p-6 rounded-lg shadow-xl flex flex-col items-center\">\n                <FaSpinner className=\"animate-spin text-blue-600 text-3xl mb-4\" />\n                <p className=\"text-gray-700\">Procesando tu solicitud...</p>\n              </div>\n            </div>\n          )}\n        </div>\n      </div>\n    </div>\n  )\n}\n"],"names":["Login","email","setEmail","useState","password","setPassword","displayName","setDisplayName","role","setRole","isLogin","setIsLogin","login","signup","loginWithGoogle","loginWithFacebook","resetPassword","loading","error","clearError","useAuth","useNavigate","emailRef","useRef","passwordRef","nameRef","useEffect","handleLogin","e","handleRegister","handleGoogleSignIn","handleFacebookSignIn","handlePasswordReset","toggleAuthMode","jsx","jsxs","FaSpinner","FaGoogle","FaFacebook","FaUser","FaEnvelope","FaLock","FaUserTie","FaUserShield","Fragment"],"mappings":"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"}